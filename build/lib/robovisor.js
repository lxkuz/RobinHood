// Generated by CoffeeScript 1.10.0
(function() {
  var Robot, Robovisor, spawn;

  Robot = require('../models/robot');

  spawn = require('child_process').spawn;

  Robovisor = (function() {
    function Robovisor() {
      Robot.findAll({
        where: {
          state: 'new'
        }
      }).then(function(robots) {
        var i, len, results, robot, watcherProcess;
        results = [];
        for (i = 0, len = robots.length; i < len; i++) {
          robot = robots[i];
          console.log(process.argv[1]);
          watcherProcess = spawn('node', ['build/lib/watcher', robot.get('id')]);
          watcherProcess.stdout.on('data', function(data) {
            return console.log("stdout: " + data);
          });
          watcherProcess.stderr.on('data', function(data) {
            return console.log("stderr: " + data);
          });
          watcherProcess.on('close', function(code) {
            return console.log("child watcherProcess exited with code " + code);
          });
          results.push(console.log("init watcherProcess for " + (robot.get('name'))));
        }
        return results;
      });
    }

    return Robovisor;

  })();

  module.exports = new Robovisor;

}).call(this);
